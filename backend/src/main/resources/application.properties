spring.profiles.active=local
server.port=8080

# 数据源配置（默认连接到本地 MySQL，可通过环境变量覆盖）
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/smart_property_system?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:root}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:root}

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
# 遵循阿里巴巴规范：禁用物理外键约束
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.properties.hibernate.physical_naming_strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
spring.jpa.properties.hibernate.check_nullability=false
# 不生成外键约束
spring.jpa.properties.org.hibernate.envers.do_not_audit_optimistic_locking_field=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# 全局时区设置
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jackson.time-zone=UTC

# JWT 相关配置
app.security.jwt.secret=${JWT_SECRET:change-me}
app.security.jwt.access-token-expiration-minutes=${JWT_ACCESS_TOKEN_EXPIRATION_MINUTES:15}
app.security.jwt.refresh-token-expiration-days=${JWT_REFRESH_TOKEN_EXPIRATION_DAYS:7}
app.security.jwt.access-cookie-name=ACCESS_TOKEN
app.security.jwt.refresh-cookie-name=REFRESH_TOKEN

# CORS
app.security.cors.allowed-origins=${APP_ALLOWED_ORIGINS:http://localhost:5173}

# 文件存储配置
file.storage.upload-dir=uploads
file.storage.max-file-size=10485760
file.storage.max-image-size=5242880
file.storage.max-document-size=10485760

# Spring文件上传配置
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ===========================================
# AI模块配置（智能客服助手）- 使用七牛云AI服务
# ===========================================
# 是否启用AI功能
app.ai.enabled=${AI_ENABLED:true}

# 七牛云AI配置
# API Key（从七牛云 API Key 管理获取）
app.ai.api-key=${OPENAI_API_KEY:sk-0f5d331b6ea3c0a8be09e425337327d3330df34e0ed8d73d1a8d0fbf6aa60e9e}

# 七牛云 OpenAI 兼容接口地址
# 主地址：https://openai.qiniu.com/v1
# 备用地址：https://api.qnaigc.com/v1
app.ai.base-url=${OPENAI_BASE_URL:https://openai.qiniu.com/v1}

# 使用的模型（七牛云模型ID）
# 示例：gpt-oss-120b（七牛云模型）
app.ai.model=${OPENAI_MODEL:gpt-oss-120b}

# 请求超时时间（秒）
app.ai.timeout=${OPENAI_TIMEOUT:60}

# 温度参数（0-2，控制输出随机性，越高越随机）
app.ai.temperature=${OPENAI_TEMPERATURE:0.7}

# 最大token数（控制返回长度）
app.ai.max-tokens=${OPENAI_MAX_TOKENS:800}

# ===========================================
# AI功能说明
# ===========================================
# 启用后，系统提供两大AI功能：
#
# 1. 维修工单智能分析：
#    - 自动分类问题类型（水电/家电/家具/门窗/清洁/其他）
#    - 评估紧急程度（低/中/高/紧急）
#    - 生成维修建议
#    - 预估维修费用
#
# 2. 全局AI聊天助手：
#    - 页面右下角悬浮球，随时对话
#    - 解答系统使用问题
#    - 提供操作指导
#    - 支持多轮上下文对话
#
# ===========================================
# 七牛云AI配置步骤
# ===========================================
# 1. 登录七牛云AI平台
# 2. 在 API Key 管理中获取您的 API Key
# 3. 修改以下配置：
#
#    方式一：直接修改本文件
#    app.ai.api-key=your-actual-api-key
#
#    方式二：使用环境变量（推荐）
#    export AI_ENABLED=true
#    export OPENAI_API_KEY=your-actual-api-key
#    export OPENAI_BASE_URL=https://openai.qiniu.com/v1
#    export OPENAI_MODEL=gpt-oss-120b
#
# 4. 重启应用，即可使用AI功能
# ===========================================
